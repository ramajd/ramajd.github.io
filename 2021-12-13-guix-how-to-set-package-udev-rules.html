<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="description" content="setup udev rules for Guix packages">
<link rel="alternate"
      type="application/rss+xml"
      href="https://ramajd.github.io/rss.xml"
      title="RSS feed for https://ramajd.github.io/">
<title>Guix: how to set package udev rules</title>

<meta name="author" content="Reza Alizadeh Majd">
<meta name="referrer" content="no-referrer">
<link href="/static/style.css" rel="stylesheet" type="text/css" />
<link rel="icon" href="/static/favicon.png"></head>
<body>
<div id="preamble" class="status">
<div class="header">
  <h1><a href="/">Personal Notes by ramajd</a></h1>
  <ul>
    <li><a href="/">Blog</a>
    <li><a href="/about.html">About</a>
  </ul>
</div></div>
<div id="content">
<div class="post-date">13 Dec 2021</div><h1 class="post-title"><a href="https://ramajd.github.io/2021-12-13-guix-how-to-set-package-udev-rules.html">Guix: how to set package udev rules</a></h1>
<blockquote>
<p>
Just read a <i><a href="https://lists.gnu.org/archive/html/guix-devel/2021-12/msg00095.html">thread</a></i> on guix mailing list, about <b>adding udev rules</b> for a
package. in order to have an fixed reference about it, I decided to post it
here.
</p>
</blockquote>

<p>
adding <code>udev</code> rules for a guix package is as easy as adding it to the
<code>&lt;out&gt;/lib/udev/rules.d/</code> directory. so we can either add it as an <code>INSTALL</code>
rule in our <code>CMakefile.txt</code> or add it to manually install the rules as part of
our package <code>install</code> phase:
</p>

<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #729FCF;">define-public</span> <span style="color: #00ffff;">package-name</span>
  (package
   ...
   (arguments
    `(<span style="color: #b0c4de;">#:phases</span>
      (modify-phases %standard-phases
       (add-after 'unpack 'patch-udev-rules
         (<span style="color: #729FCF;">lambda*</span> (<span style="color: #b0c4de;">#:key</span> outputs <span style="color: #b0c4de;">#:allow-other-keys</span>)
           (<span style="color: #729FCF;">let</span> ((out (assoc-ref outputs <span style="color: #8AE234;">"out"</span>)))
             (substitute* <span style="color: #8AE234;">"CMakefile.txt"</span>
                          ((<span style="color: #8AE234;">"/ib/udev/rules.d"</span>)
                           (string-append out <span style="color: #8AE234;">"/lib/udev/rules.d"</span>)))
             #t))))))
   ...))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #729FCF;">define-public</span> <span style="color: #00ffff;">package-name</span>
  (package
   ...
   (arguments
    `(<span style="color: #b0c4de;">#:phases</span>
      (modify-phases %standard-phases
       (add-after 'install 'install-udev-rules
         (<span style="color: #729FCF;">lambda*</span> (<span style="color: #b0c4de;">#:key</span> outputs <span style="color: #b0c4de;">#:allow-other-keys</span>)
           (<span style="color: #729FCF;">let</span> ((out (assoc-ref outputs <span style="color: #8AE234;">"out"</span>)))
             (mkdir-p (string-append out <span style="color: #8AE234;">"/lib/udev/rules.d"</span>))
             (copy-file <span style="color: #8AE234;">"123-my-custom-udev.rules"</span>
                        (string-append out
                                       <span style="color: #8AE234;">"/lib/udev/rules.d/"</span>
                                       <span style="color: #8AE234;">"123-my-custom-udev.rules"</span>))
             #t))))))
   ...
   ))
</pre>
</div>
<div class="taglist"><a href="https://ramajd.github.io/tags.html">Tags</a>: <a href="https://ramajd.github.io/tag-guix.html">guix</a> </div></div>
<div id="postamble" class="status">
<center>
  <a rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/">
    <img alt="Creative Commons License" 
         style="border-width:0" 
         src="https://i.creativecommons.org/l/by-sa/3.0/88x31.png" /></a>
  <br />
  licensed under a 
  <a rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/">
    Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.
</center></div>
</body>
</html>
